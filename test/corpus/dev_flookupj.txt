========
flookupj
========

=map(search_key,lambda(j,
    if(j="",,sortn(
        result_range,1,,
        iferror(map(if(n(lookup_range)^0,j),lookup_range,
            lambda(h,i,lambda(f,
                f(f,h,i,1,floor(max(len(h),len(i))/2)-1)
            )(lambda(f,x,y,n,z,
                if(
                    n>len(x),
                    lambda(g,
                        average(
                            g/len(h),
                            g/len(i),
                            (g-index(reduce(
                                {1,0},
                                sequence(len(h)),
                                lambda(a,c,
                                    if(
                                        --mid(x,c,1),
                                        {find(1,y,index(a,1))+1,index(a,2)}+
                                        if(mid(h,c,1)=mid(i,find(1,y,index(a,1)),1),0,{0,1}),
                                        a
                                    )
                                )
                            ),2)/2)/g
                        )
                    )(sum(--mid(x,sequence(len(h)),1))),
                    lambda(a,
                        if(
                            iserr(a),
                            f(f,substitute(x,mid(x,n,1),0,1),y,n+1,z),
                            f(f,substitute(x,mid(x,n,1),1,1),left(y,a-1)&1&mid(y,a+1,9^9),n+1,z)
                        )
                    )(find(mid(x,n,1),left(y,n+z),max(1,n-z)))
                )
            )))
        )),
    ))
))

---

(source_file
  (function_call
    (identifier)
    (identifier)
    (function_call
      (identifier)
      (identifier)
      (function_call
        (identifier)
        (operator_expression
          (identifier)
          (binary_operator)
          (string))
        (function_call
          (identifier)
          (identifier)
          (number)
          (function_call
            (identifier)
            (function_call
              (identifier)
              (function_call
                (identifier)
                (operator_expression
                  (function_call
                    (identifier)
                    (identifier))
                  (binary_operator)
                  (number))
                (identifier))
              (identifier)
              (function_call
                (identifier)
                (identifier)
                (identifier)
                (function_call
                  (function_call
                    (identifier)
                    (identifier)
                    (function_call
                      (identifier)
                      (identifier)
                      (identifier)
                      (identifier)
                      (number)
                      (operator_expression
                        (function_call
                          (identifier)
                          (operator_expression
                            (function_call
                              (identifier)
                              (function_call
                                (identifier)
                                (identifier))
                              (function_call
                                (identifier)
                                (identifier)))
                            (binary_operator)
                            (number)))
                        (binary_operator)
                        (number))))
                  (function_call
                    (identifier)
                    (identifier)
                    (identifier)
                    (identifier)
                    (identifier)
                    (identifier)
                    (function_call
                      (identifier)
                      (operator_expression
                        (identifier)
                        (binary_operator)
                        (function_call
                          (identifier)
                          (identifier)))
                      (function_call
                        (function_call
                          (identifier)
                          (identifier)
                          (function_call
                            (identifier)
                            (operator_expression
                              (identifier)
                              (binary_operator)
                              (function_call
                                (identifier)
                                (identifier)))
                            (operator_expression
                              (identifier)
                              (binary_operator)
                              (function_call
                                (identifier)
                                (identifier)))
                            (operator_expression
                              (parenthesized_expression
                                (operator_expression
                                  (operator_expression
                                    (identifier)
                                    (binary_operator)
                                    (function_call
                                      (identifier)
                                      (function_call
                                        (identifier)
                                        (array_literal
                                          (number)
                                          (number))
                                        (function_call
                                          (identifier)
                                          (function_call
                                            (identifier)
                                            (identifier)))
                                        (function_call
                                          (identifier)
                                          (identifier)
                                          (identifier)
                                          (function_call
                                            (identifier)
                                            (operator_expression
                                              (unary_operator)
                                              (operator_expression
                                                (unary_operator)
                                                (function_call
                                                  (identifier)
                                                  (identifier)
                                                  (identifier)
                                                  (number))))
                                            (operator_expression
                                              (array_literal
                                                (operator_expression
                                                  (function_call
                                                    (identifier)
                                                    (number)
                                                    (identifier)
                                                    (function_call
                                                      (identifier)
                                                      (identifier)
                                                      (number)))
                                                  (binary_operator)
                                                  (number))
                                                (function_call
                                                  (identifier)
                                                  (identifier)
                                                  (number)))
                                              (binary_operator)
                                              (function_call
                                                (identifier)
                                                (operator_expression
                                                  (function_call
                                                    (identifier)
                                                    (identifier)
                                                    (identifier)
                                                    (number))
                                                  (binary_operator)
                                                  (function_call
                                                    (identifier)
                                                    (identifier)
                                                    (function_call
                                                      (identifier)
                                                      (number)
                                                      (identifier)
                                                      (function_call
                                                        (identifier)
                                                        (identifier)
                                                        (number)))
                                                    (number)))
                                                (number)
                                                (array_literal
                                                  (number)
                                                  (number))))
                                            (identifier))))
                                      (number)))
                                  (binary_operator)
                                  (number)))
                              (binary_operator)
                              (identifier))))
                        (function_call
                          (identifier)
                          (operator_expression
                            (unary_operator)
                            (operator_expression
                              (unary_operator)
                              (function_call
                                (identifier)
                                (identifier)
                                (function_call
                                  (identifier)
                                  (function_call
                                    (identifier)
                                    (identifier)))
                                (number))))))
                      (function_call
                        (function_call
                          (identifier)
                          (identifier)
                          (function_call
                            (identifier)
                            (function_call
                              (identifier)
                              (identifier))
                            (function_call
                              (identifier)
                              (identifier)
                              (function_call
                                (identifier)
                                (identifier)
                                (function_call
                                  (identifier)
                                  (identifier)
                                  (identifier)
                                  (number))
                                (number)
                                (number))
                              (identifier)
                              (operator_expression
                                (identifier)
                                (binary_operator)
                                (number))
                              (identifier))
                            (function_call
                              (identifier)
                              (identifier)
                              (function_call
                                (identifier)
                                (identifier)
                                (function_call
                                  (identifier)
                                  (identifier)
                                  (identifier)
                                  (number))
                                (number)
                                (number))
                              (operator_expression
                                (operator_expression
                                  (function_call
                                    (identifier)
                                    (identifier)
                                    (operator_expression
                                      (identifier)
                                      (binary_operator)
                                      (number)))
                                  (binary_operator)
                                  (number))
                                (binary_operator)
                                (function_call
                                  (identifier)
                                  (identifier)
                                  (operator_expression
                                    (identifier)
                                    (binary_operator)
                                    (number))
                                  (operator_expression
                                    (number)
                                    (binary_operator)
                                    (number))))
                              (operator_expression
                                (identifier)
                                (binary_operator)
                                (number))
                              (identifier))))
                        (function_call
                          (identifier)
                          (function_call
                            (identifier)
                            (identifier)
                            (identifier)
                            (number))
                          (function_call
                            (identifier)
                            (identifier)
                            (operator_expression
                              (identifier)
                              (binary_operator)
                              (identifier)))
                          (function_call
                            (identifier)
                            (number)
                            (operator_expression
                              (identifier)
                              (binary_operator)
                              (identifier))))))))))))))))
