=========
doformula
=========

=let(funcs,
    {
        "SIN",
        "COS",
        "TAN",
        "COT",
        "ATN",
        "EXP",
        "LOG",
        "ABS",
        "SQR"
    },
    curfunc, regexextract(in, "^.*?("&join("|",funcs)&")([\d.-]+)"),
    arg, index(curfunc, 2),
    out, choose(match(single(curfunc),funcs,),
            sin(arg),
            cos(arg),
            tan(arg),
            cot(arg),
            atan(arg),
            exp(arg),
            ln(arg),
            abs(arg),
            sqrt(arg)
    ),
    if(iserror(curfunc),in,
        regexreplace(in, "(^.*?)("&join("|",funcs)&")([\d.-]+)", "$1"&out)
    )
)

---

(source_file
  (function_call
    (identifier)
    (arguments
      (argument
        (identifier))
      (argument
        (array_literal
          (string)
          (string)
          (string)
          (string)
          (string)
          (string)
          (string)
          (string)
          (string)))
      (argument
        (identifier))
      (argument
        (function_call
          (identifier)
          (arguments
            (argument
              (identifier))
            (argument
              (operator_expression
                (operator_expression
                  (string)
                  (binary_operator)
                  (function_call
                    (identifier)
                    (arguments
                      (argument
                        (string))
                      (argument
                        (identifier)))))
                (binary_operator)
                (string))))))
      (argument
        (identifier))
      (argument
        (function_call
          (identifier)
          (arguments
            (argument
              (identifier))
            (argument
              (number)))))
      (argument
        (identifier))
      (argument
        (function_call
          (identifier)
          (arguments
            (argument
              (function_call
                (identifier)
                (arguments
                  (argument
                    (function_call
                      (identifier)
                      (arguments
                        (argument
                          (identifier)))))
                  (argument
                    (identifier)))))
            (argument
              (function_call
                (identifier)
                (arguments
                  (argument
                    (identifier)))))
            (argument
              (function_call
                (identifier)
                (arguments
                  (argument
                    (identifier)))))
            (argument
              (function_call
                (identifier)
                (arguments
                  (argument
                    (identifier)))))
            (argument
              (function_call
                (identifier)
                (arguments
                  (argument
                    (identifier)))))
            (argument
              (function_call
                (identifier)
                (arguments
                  (argument
                    (identifier)))))
            (argument
              (function_call
                (identifier)
                (arguments
                  (argument
                    (identifier)))))
            (argument
              (function_call
                (identifier)
                (arguments
                  (argument
                    (identifier)))))
            (argument
              (function_call
                (identifier)
                (arguments
                  (argument
                    (identifier)))))
            (argument
              (function_call
                (identifier)
                (arguments
                  (argument
                    (identifier))))))))
      (argument
        (function_call
          (identifier)
          (arguments
            (argument
              (function_call
                (identifier)
                (arguments
                  (argument
                    (identifier)))))
            (argument
              (identifier))
            (argument
              (function_call
                (identifier)
                (arguments
                  (argument
                    (identifier))
                  (argument
                    (operator_expression
                      (operator_expression
                        (string)
                        (binary_operator)
                        (function_call
                          (identifier)
                          (arguments
                            (argument
                              (string))
                            (argument
                              (identifier)))))
                      (binary_operator)
                      (string)))
                  (argument
                    (operator_expression
                      (string)
                      (binary_operator)
                      (identifier))))))))))))
